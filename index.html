<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Minik ƒ∞ngilizce ‚Äî Metehan</title>
<style>
  body {
    font-family: "Comic Sans MS", sans-serif;
    margin: 0;
    background: linear-gradient(180deg, #fff5e1, #e8f6ff);
    color: #333;
  }
  header {
    background: #ff6b6b;
    color: #fff;
    text-align: center;
    padding: 15px;
    font-size: 20px;
    font-weight: bold;
  }
  main {
    padding: 15px;
  }
  .menu {
    display: flex;
    justify-content: space-around;
    margin-bottom: 15px;
  }
  .menu button {
    background: #ffd166;
    border: none;
    padding: 10px;
    border-radius: 10px;
    font-weight: bold;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }
  .thumb {
    border: 4px solid transparent;
    border-radius: 12px;
    overflow: hidden;
    background: white;
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
  }
  .thumb img {
    width: 100%;
    height: 160px;
    object-fit: contain;
    background: #f8f8f8;
  }
  .label {
    text-align: center;
    font-weight: bold;
    padding: 8px;
  }
  .correct {
    border-color: #34c759 !important;
  }
  .wrong {
    border-color: #ff3b30 !important;
  }
  input, button {
    font-size: 16px;
  }
</style>
</head>
<body>
  <header>üéâ Metehan‚Äôƒ±n Minik ƒ∞ngilizce Uygulamasƒ± üéâ</header>

  <main>
    <div class="menu">
      <button onclick="showView('home')">üè† Anasayfa</button>
      <button onclick="showView('add')">‚ûï Kelime Ekle</button>
      <button onclick="showView('quiz')">üß© Test</button>
    </div>

    <div id="view-home">
      <h3>üìö K√ºt√ºphane</h3>
      <div id="gallery" class="grid"></div>
    </div>

    <div id="view-add" style="display:none;">
      <h3>Kelime Ekle</h3>
      <input id="word" type="text" placeholder="ƒ∞ngilizce kelime" style="width:100%;padding:8px;border-radius:8px;"><br><br>
      <input id="imgLink" type="text" placeholder="Fotoƒüraf linkini yapƒ±≈ütƒ±r (https://...)" style="width:100%;padding:8px;border-radius:8px;"><br><br>
      <button onclick="saveWord()" style="background:#6b8bff;color:white;padding:10px;border:none;border-radius:10px;">Kaydet</button>
    </div>

    <div id="view-quiz" style="display:none;">
      <h3>Test</h3>
      <button onclick="startQuiz()" style="background:#34c759;color:white;padding:10px;border:none;border-radius:10px;">Teste Ba≈üla</button>
      <div id="quizArea" style="margin-top:15px;"></div>
    </div>
  </main>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwdjZGT1CuJlFiATRRzIWtmN1e2QFsGq7BEjEhJql5MzWdXoQjgfze_A2hkjsSz7oTUsQ/exec"; // ‚Üê Google Apps Script URL buraya

let words = [];
let currentQuiz = null;

async function loadWords() {
  const res = await fetch(API_URL + "?action=get");
  words = await res.json();
  renderGallery();
}

function showView(v) {
  document.querySelectorAll("#view-home,#view-add,#view-quiz").forEach(el => el.style.display = "none");
  document.getElementById("view-" + v).style.display = "block";
  if (v === "home") loadWords();
}

function renderGallery() {
  const g = document.getElementById("gallery");
  g.innerHTML = "";
  if (words.length === 0) {
    g.innerHTML = "<div>Hen√ºz kelime yok</div>";
    return;
  }
  words.forEach(w => {
    const d = document.createElement("div");
    d.className = "thumb";
    d.innerHTML = `<img src="${w.image}" alt="${w.word}"><div class="label">${w.word}</div>`;
    d.onclick = () => speak(w.word);
    g.appendChild(d);
  });
}

async function saveWord() {
  const word = document.getElementById("word").value.trim();
  const image = document.getElementById("imgLink").value.trim();
  if (!word || !image) {
    alert("L√ºtfen kelime ve fotoƒüraf linkini gir.");
    return;
  }
  await fetch(API_URL + "?action=add", {
    method: "POST",
    body: JSON.stringify({ word, image }),
    headers: { "Content-Type": "application/json" }
  });
  alert("Kaydedildi!");
  document.getElementById("word").value = "";
  document.getElementById("imgLink").value = "";
  showView("home");
}

function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  window.speechSynthesis.speak(u);
}

function startQuiz() {
  if (words.length === 0) {
    alert("√ñnce kelime ekle!");
    return;
  }
  currentQuiz = { index: 0, results: [] };
  renderQuizQuestion();
}

function renderQuizQuestion() {
  const quiz = document.getElementById("quizArea");
  quiz.innerHTML = "";
  const q = words[currentQuiz.index];
  const options = shuffle(words).slice(0,4);
  if (!options.includes(q)) options[0] = q;
  quiz.innerHTML = `<button onclick="speak('${q.word}')">üîä Dinle</button>`;
  const grid = document.createElement("div");
  grid.className = "grid";
  options.forEach(opt => {
    const div = document.createElement("div");
    div.className = "thumb";
    div.innerHTML = `<img src="${opt.image}">`;
    div.onclick = () => checkAnswer(opt.word === q.word, div);
    grid.appendChild(div);
  });
  quiz.appendChild(grid);
}

function checkAnswer(correct, div) {
  if (correct) {
    div.classList.add("correct");
    speak("Tebrikler Metehan! Doƒüru cevapladƒ±n!");
  } else {
    div.classList.add("wrong");
    speak("Yanlƒ±≈ü Metehan, tekrar dene!");
  }
  setTimeout(() => {
    currentQuiz.index++;
    if (currentQuiz.index < words.length) renderQuizQuestion();
    else speak("Test bitti, aferin Metehan!");
  }, 2000);
}

function shuffle(a) {
  for (let i=a.length-1; i>0; i--) {
    const j = Math.floor(Math.random()*(i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

loadWords();
</script>
</body>
</html>
